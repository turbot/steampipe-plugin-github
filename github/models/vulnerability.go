package models

import "github.com/shurcooL/githubv4"

type RepositoryVulnerabilityAlert struct {
	NodeId                     string                                               `graphql:"nodeId: id" json:"node_id"`
	Number                     int                                                  `json:"number"`
	AutoDismissedAt            NullableTime                                         `json:"auto_dismissed_at"`
	CreatedAt                  NullableTime                                         `json:"created_at"`
	DependencyScope            githubv4.RepositoryVulnerabilityAlertDependencyScope `json:"dependency_scope"`
	DismissComment             string                                               `json:"dismiss_comment"`
	DismissReason              string                                               `json:"dismiss_reason"`
	DismissedAt                NullableTime                                         `json:"dismissed_at"`
	Dismisser                  BasicUser                                            `json:"dismisser"`
	FixedAt                    NullableTime                                         `json:"fixed_at"`
	State                      githubv4.RepositoryVulnerabilityAlertState           `json:"state"`
	SecurityAdvisory           SecurityAdvisory                                     `json:"security_advisory"`
	SecurityVulnerability      SecurityVulnerability                                `json:"security_vulnerability"`
	VulnerableManifestFilename string                                               `json:"vulnerable_manifest_filename"`
	VulnerableManifestPath     string                                               `json:"vulnerable_manifest_path"`
	VulnerableRequirements     string                                               `json:"vulnerable_requirements"`
}

type SecurityAdvisory struct {
	Id                     int                                     `graphql:"id: databaseId" json:"id"`
	NodeId                 string                                  `graphql:"nodeId: id" json:"node_id"`
	Classification         githubv4.SecurityAdvisoryClassification `json:"classification"`
	Cvss                   CVSS                                    `json:"cvss"`
	Description            string                                  `json:"description"`
	GhsaId                 string                                  `json:"ghsa_id"`
	Identifiers            []SecurityAdvisoryIdentifier            `json:"identifiers"`
	NotificationsPermalink string                                  `json:"notifications_permalink"`
	Origin                 string                                  `json:"origin"`
	Permalink              string                                  `json:"permalink"`
	PublishedAt            NullableTime                            `json:"published_at"`
	References             []SecurityAdvisoryReference             `json:"references"`
	Severity               githubv4.SecurityAdvisorySeverity       `json:"severity"`
	Summary                string                                  `json:"summary"`
	UpdatedAt              NullableTime                            `json:"updated_at"`
	WithdrawnAt            NullableTime                            `json:"withdrawn_at"`
}

type SecurityAdvisoryIdentifier struct {
	Type  string `json:"type"`
	Value string `json:"value"`
}

type SecurityAdvisoryReference struct {
	Url string `json:"url"`
}

type SecurityAdvisoryPackageVersion struct {
	Identifier string `json:"identifier"`
}

type SecurityAdvisoryPackage struct {
	Name      string                             `json:"name"`
	Ecosystem githubv4.SecurityAdvisoryEcosystem `json:"ecosystem"`
}

type SecurityVulnerability struct {
	Advisory               SecurityAdvisory                  `json:"advisory"`
	FirstPatchedVersion    SecurityAdvisoryPackageVersion    `json:"first_patched_version"`
	Package                SecurityAdvisoryPackage           `json:"package"`
	Severity               githubv4.SecurityAdvisorySeverity `json:"severity"`
	UpdatedAt              NullableTime                      `json:"updated_at"`
	VulnerableVersionRange string                            `json:"vulnerable_version_range"`
}

type CVSS struct {
	Score        float32 `json:"score"`
	VectorString string  `json:"vector_string"`
}
