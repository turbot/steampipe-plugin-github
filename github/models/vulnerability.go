package models

import "github.com/shurcooL/githubv4"

type RepositoryVulnerabilityAlert struct {
	NodeId                     string                                               `graphql:"nodeId: id @include(if:$includeVulnerabilityAlertNodeId)" json:"node_id"`
	Number                     int                                                  `graphql:"number: number @include(if:$includeVulnerabilityAlertNumber)" json:"number"`
	AutoDismissedAt            NullableTime                                         `graphql:"autoDismissedAt: autoDismissedAt @include(if:$includeVulnerabilityAlertAutoDismissedAt)" json:"auto_dismissed_at"`
	CreatedAt                  NullableTime                                         `graphql:"createdAt: createdAt @include(if:$includeVulnerabilityAlertCreatedAt)" json:"created_at"`
	DependencyScope            githubv4.RepositoryVulnerabilityAlertDependencyScope `graphql:"dependencyScope: dependencyScope @include(if:$includeVulnerabilityAlertDependencyScope)" json:"dependency_scope"`
	DismissComment             string                                               `graphql:"dismissComment: dismissComment @include(if:$includeVulnerabilityAlertDismissComment)" json:"dismiss_comment"`
	DismissReason              string                                               `graphql:"dismissReason: dismissReason @include(if:$includeVulnerabilityAlertDismissReason)" json:"dismiss_reason"`
	DismissedAt                NullableTime                                         `graphql:"dismissedAt: dismissedAt @include(if:$includeVulnerabilityAlertDismissedAt)" json:"dismissed_at"`
	Dismisser                  BasicUser                                            `graphql:"dismisser: dismisser @include(if:$includeVulnerabilityAlertDismisser)" json:"dismisser"`
	FixedAt                    NullableTime                                         `graphql:"fixedAt: fixedAt @include(if:$includeVulnerabilityAlertFixedAt)" json:"fixed_at"`
	State                      githubv4.RepositoryVulnerabilityAlertState           `graphql:"state: state @include(if:$includeVulnerabilityAlertState)" json:"state"`
	SecurityAdvisory           SecurityAdvisory                                     `graphql:"securityAdvisory: securityAdvisory @include(if:$includeVulnerabilityAlertSecurityAdvisory)" json:"security_advisory"`
	SecurityVulnerability      SecurityVulnerability                                `graphql:"securityVulnerability: securityVulnerability @include(if:$includeVulnerabilityAlertSecurityVulnerability)" json:"security_vulnerability"`
	VulnerableManifestFilename string                                               `graphql:"vulnerableManifestFilename: vulnerableManifestFilename @include(if:$includeVulnerabilityAlertVulnerableManifestFilename)" json:"vulnerable_manifest_filename"`
	VulnerableManifestPath     string                                               `graphql:"vulnerableManifestPath: vulnerableManifestPath @include(if:$includeVulnerabilityAlertVulnerableManifestPath)" json:"vulnerable_manifest_path"`
	VulnerableRequirements     string                                               `graphql:"vulnerableRequirements: vulnerableRequirements @include(if:$includeVulnerabilityAlertVulnerableRequirements)" json:"vulnerable_requirements"`
}

type SecurityAdvisory struct {
	Id                     int                                     `graphql:"id: databaseId" json:"id"`
	NodeId                 string                                  `graphql:"nodeId: id" json:"node_id"`
	Classification         githubv4.SecurityAdvisoryClassification `json:"classification"`
	Cvss                   CVSS                                    `json:"cvss"`
	Description            string                                  `json:"description"`
	GhsaId                 string                                  `json:"ghsa_id"`
	Identifiers            []SecurityAdvisoryIdentifier            `json:"identifiers"`
	NotificationsPermalink string                                  `json:"notifications_permalink"`
	Origin                 string                                  `json:"origin"`
	Permalink              string                                  `json:"permalink"`
	PublishedAt            NullableTime                            `json:"published_at"`
	References             []SecurityAdvisoryReference             `json:"references"`
	Severity               githubv4.SecurityAdvisorySeverity       `json:"severity"`
	Summary                string                                  `json:"summary"`
	UpdatedAt              NullableTime                            `json:"updated_at"`
	WithdrawnAt            NullableTime                            `json:"withdrawn_at"`
}

type SecurityAdvisoryIdentifier struct {
	Type  string `json:"type"`
	Value string `json:"value"`
}

type SecurityAdvisoryReference struct {
	Url string `json:"url"`
}

type SecurityAdvisoryPackageVersion struct {
	Identifier string `json:"identifier"`
}

type SecurityAdvisoryPackage struct {
	Name      string                             `json:"name"`
	Ecosystem githubv4.SecurityAdvisoryEcosystem `json:"ecosystem"`
}

type SecurityVulnerability struct {
	Advisory               SecurityAdvisory                  `json:"advisory"`
	FirstPatchedVersion    SecurityAdvisoryPackageVersion    `json:"first_patched_version"`
	Package                SecurityAdvisoryPackage           `json:"package"`
	Severity               githubv4.SecurityAdvisorySeverity `json:"severity"`
	UpdatedAt              NullableTime                      `json:"updated_at"`
	VulnerableVersionRange string                            `json:"vulnerable_version_range"`
}

type CVSS struct {
	Score        float32 `json:"score"`
	VectorString string  `json:"vector_string"`
}
